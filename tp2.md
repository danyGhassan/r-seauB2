# TP2 : Environnement virtuel

## TP2 : Environnement virtuel

### ☀️ Sur node1.lan1.tp2

- afficher ses cartes réseau
```
[dany@node1 ~]$ ip a
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host
       valid_lft forever preferred_lft forever
2: enp0s3: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP group default qlen 1000
    link/ether 08:00:27:c5:de:2e brd ff:ff:ff:ff:ff:ff
    inet 10.1.1.11/24 brd 10.1.1.255 scope global noprefixroute enp0s3
       valid_lft forever preferred_lft forever
    inet6 fe80::a00:27ff:fec5:de2e/64 scope link
       valid_lft forever preferred_lft forever
```
- afficher sa table de routage
```
[dany@node1 ~]$ ip r s
default via 10.1.1.254 dev enp0s3 proto static metric 100
10.1.1.0/24 dev enp0s3 proto kernel scope link src 10.1.1.11 metric 100
```
- prouvez avec un traceroute que le paquet passe bien par router.tp2
```
[dany@node1 ~]$ traceroute 10.1.2.12
traceroute to 10.1.2.12 (10.1.2.12), 30 hops max, 60 byte packets
 1  _gateway (10.1.1.254)  32.111 ms  32.035 ms *
 2  10.1.2.12 (10.1.2.12)  35.642 ms !X  35.531 ms !X  35.488 ms !X
```
## II. Interlude accès internet
- ☀️ Sur router.tp2
```
[dany@router ~]$ ping 1.1.1.1
PING 1.1.1.1 (1.1.1.1) 56(84) bytes of data.
64 bytes from 1.1.1.1: icmp_seq=1 ttl=55 time=33.8 ms
64 bytes from 1.1.1.1: icmp_seq=2 ttl=55 time=29.7 ms
^C
--- 1.1.1.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1010ms
rtt min/avg/max/mdev = 29.671/31.726/33.782/2.055 ms
[dany@router ~]$ ping ynov.com
PING ynov.com (104.26.11.233) 56(84) bytes of data.
64 bytes from 104.26.11.233 (104.26.11.233): icmp_seq=1 ttl=55 time=23.0 ms
64 bytes from 104.26.11.233 (104.26.11.233): icmp_seq=2 ttl=55 time=15.7 ms
^C
```
### ☀️ Accès internet LAN1 et LAN2

- configurez l'adresse d'un serveur DNS que vos machines peuvent utiliser pour résoudre des noms

```
# Generated by NetworkManager
search lan
nameserver 192.168.1.254

```
- prouvez que node2.lan1.tp2 a un accès internet :

```
[dany@node2 network-scripts]$ ping 1.1.1.1
PING 1.1.1.1 (1.1.1.1) 56(84) bytes of data.
64 bytes from 1.1.1.1: icmp_seq=1 ttl=54 time=46.3 ms
64 bytes from 1.1.1.1: icmp_seq=2 ttl=54 time=14.7 ms
^C
--- 1.1.1.1 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1010ms
rtt min/avg/max/mdev = 14.682/30.488/46.295/15.806 ms
[dany@node2 network-scripts]$ ping ynov.com
PING ynov.com (104.26.11.233) 56(84) bytes of data.
64 bytes from 104.26.11.233 (104.26.11.233): icmp_seq=1 ttl=54 time=15.6 ms
64 bytes from 104.26.11.233 (104.26.11.233): icmp_seq=2 ttl=54 time=20.5 ms
^C
--- ynov.com ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1013ms
rtt min/avg/max/mdev = 15.631/18.059/20.488/2.428 ms
```

## III. Services réseau
### ☀️ Sur web.lan2.tp2
- prouvez qu'il y a un programme NGINX qui tourne derrière le port 80 de la machine (commande ss)
```
[dany@web ~]$ ss -lnre | grep "nginx"
tcp   LISTEN 0      511                                       0.0.0.0:80               0.0.0.0:*    ino:23147 sk:1003 cgroup:/system.slice/nginx.service <->
tcp   LISTEN 0      511                                          [::]:80                  [::]:*    ino:23148 sk:1005 cgroup:/system.slice/nginx.service v6only:1 <->
```

- prouvez que le firewall est bien configuré
```
[dany@web ~]$ sudo firewall-cmd --state
running
```

### ☀️ Sur node1.lan1.tp2
-visitez le site nul avec une commande curl et en utilisant le nom site_nul.tp2
```

```